# MSA (Multiple Sequence Alignment)

## MSA 정의
- MSA란 3개 이상의 DNA, RNA, Protein과 같은 서열들을 sequence alignment를 진행하는 것을 말합니다.
- 여러 개의 서열을 정렬하여, 서로 유사한 부분을 찾고, 그 서열들 간의 진화적 관계나 기능적 관계를 분석하는 방법입니다.
- 주로 단백질 서열, RNA 서열, DNA 서열 등을 비교할 때 사용됩니다.
- MSA는 다양한 생물학적 문제를 해결하는 데 중요한 역할을 합니다.
- 예를 들어, 유전자 발현 분석, 단백질 구조 예측, 진화 분석 등이 있습니다.

## MSA 목적
- 여러 서열을 정렬하여 그들 간의 상동성(homology)을 비교하고, 공통된 특징을 발견하는 것입니다. 이를 통해:
  - 서열 보존 영역 (conserved regions) 을 찾을 수 있습니다.
  - 기능적 중요 부위를 식별할 수 있습니다.
  - 서열 간의 진화적 관계를 추정할 수 있습니다.

## MSA의 주요 단계
- 서열 수집: 먼저 분석할 서열들을 선택합니다. 예를 들어, 동일한 유전자 또는 단백질을 가진 여러 생물체의 서열을 수집할 수 있습니다.
- 서열 정렬: 수집한 서열들을 정렬합니다. 이 단계에서는 각 서열의 유사성, 차이점 및 보존된 패턴을 찾아냅니다.
- 정렬 결과 해석: 정렬된 서열에서 보존된 영역, 변이가 나타나는 영역 등을 분석합니다.

## MSA 알고리즘
- MSA를 수행하는 다양한 알고리즘이 있으며, 각 알고리즘은 효율성과 정확도가 다릅니다. 
- 주요 알고리즘에는 다음과 같은 것들이 있습니다.
**1. Progressive Alignment (점진적 정렬):**  
- 가장 널리 사용되는 알고리즘입니다.
- 먼저 두 개의 서열을 정렬한 뒤, 가장 유사한 서열들을 점진적으로 추가해 나갑니다.
- ClustalW와 MAFFT가 이 방식으로 동작합니다.
- 장점: 계산이 비교적 간단하고, 다수의 서열에 대해 빠르게 적용할 수 있습니다.
- 단점: 서열 간의 거리가 크게 다르면 정렬 정확도가 떨어질 수 있습니다.
**2. Iterative Refinement (반복적 정제):**  
- 초기 정렬을 수행한 후, 정렬을 반복적으로 개선합니다.
- 정렬을 여러 번 수정하여 최적화된 결과를 얻습니다.
- T-Coffee, Muscle 등이 이 방식으로 동작합니다.
- 장점: 높은 정확도를 보장합니다.
- 단점: 계산 비용이 높고 시간이 많이 걸릴 수 있습니다.
**3. Hidden Markov Model (HMM):**  
- 서열의 각 위치에 대해 확률 모델을 사용하여 정렬을 수행합니다.
- 특히 Pfam, HMMER와 같은 도구에서 사용됩니다.
- 장점: 확률적 모델을 통해 더 정교한 정렬을 제공합니다.
- 단점: 계산이 더 복잡하고 시간이 더 소요됩니다.

## MSA 도구들
다양한 MSA 도구들이 존재하며, 사용자의 요구와 데이터의 특성에 따라 선택할 수 있습니다. 주요 도구들은 다음과 같습니다:
- ClustalW: 가장 유명한 MSA 도구로, 빠르고 간단한 점진적 정렬 방식으로 서열을 정렬합니다.
- MAFFT: 빠른 속도와 높은 정확도를 자랑하는 MSA 도구로, 점진적 정렬과 반복적 정제를 지원합니다.
- T-Coffee: 정밀한 정렬을 위해 사용되는 도구로, 다양한 정렬 알고리즘을 결합하여 최적의 결과를 제공합니다.
- MUSCLE: 고속 정렬을 위한 도구로, 반복적 정제 알고리즘을 기반으로 높은 정확도를 보입니다.
- HMMER: HMM 기반의 도구로, 단백질 도메인 분석 및 서열 검색에 유용합니다.

## MSA의 응용 분야
MSA는 여러 생물학적 문제에서 중요한 역할을 합니다:  
1. 진화 분석 (Phylogenetic analysis):
MSA를 통해 서열 간의 유사성을 비교하고, 이 정보를 바탕으로 진화적 관계를 추론합니다.  
2. 기능적 분석 (Functional analysis):
서열의 보존된 영역을 통해 기능적으로 중요한 부분을 추론할 수 있습니다.  
예를 들어, 단백질의 활성 부위나 리간드 결합 부위를 예측할 수 있습니다.  
3. 단백질 구조 예측 (Protein structure prediction):
MSA를 사용하여 단백질의 3D 구조 예측에 필요한 서열 동질성을 분석할 수 있습니다.  
4. 질병 관련 분석 (Disease-related analysis):
질병과 관련된 유전자나 단백질의 변이를 분석하는 데 사용됩니다.  
MSA를 통해 돌연변이 위치를 식별하고, 그 변이가 생리학적으로 어떤 영향을 미칠 수 있는지 예측할 수 있습니다.

## MSA 결과 해석
MSA 결과에서 주의 깊게 살펴봐야 할 주요 지표는 다음과 같습니다:  
1. 보존된 영역 (Conserved regions):  
서열들 간에 일정한 부분이 반복되거나 변하지 않는 영역을 찾습니다.  
이 영역들은 보통 생리적 기능을 가진 중요 부위일 가능성이 큽니다.  
2. 변이 영역 (Variant regions):  
서열들 간에 차이가 나는 부분을 찾아냅니다. 이 변이는 진화적 차이나 특정 질병과의 관련성을 나타낼 수 있습니다.  
3. Gaps:   
정렬된 서열에서 공백이 생긴 위치를 확인합니다.  
이 공백은 서열 간에 삽입된 염기나 아미노산을 나타내며, 특정 진화적 변이나 서열 특성을 반영할 수 있습니다.

## 결론
MSA는 여러 서열을 비교하고 분석하는 데 필수적인 도구로, 유전자 및 단백질 기능을 연구하는 데 중요한 역할을 합니다.   
다양한 알고리즘과 도구들이 있으며, 각 도구는 성능, 속도, 정확도가 다릅니다.   
사용자는 분석할 서열의 특성과 요구 사항에 맞는 도구를 선택하여 MSA를 수행할 수 있습니다.   
MSA 결과는 단백질 구조 예측, 진화 분석, 질병 관련 연구 등 여러 분야에서 매우 유용하게 활용됩니다.  
